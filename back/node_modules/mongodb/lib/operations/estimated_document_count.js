"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EstimatedDocumentCountOperation = void 0;
const operation_1 = require("./operation");
const command_1 = require("./command");
/** @internal */
class EstimatedDocumentCountOperation extends command_1.CommandOperation {
    constructor(collection, query, options) {
        if (typeof options === 'undefined') {
            options = query;
            query = undefined;
        }
        super(collection, options);
        this.options = options;
        this.collectionName = collection.collectionName;
        if (query) {
            this.query = query;
        }
    }
    execute(server, session, callback) {
        const options = this.options;
        const cmd = { count: this.collectionName };
        if (this.query) {
            cmd.query = this.query;
        }
        if (typeof options.skip === 'number') {
            cmd.skip = options.skip;
        }
        if (typeof options.limit === 'number') {
            cmd.limit = options.limit;
        }
        if (options.hint) {
            cmd.hint = options.hint;
        }
        super.executeCommand(server, session, cmd, (err, response) => {
            if (err) {
                callback(err);
                return;
            }
            callback(undefined, response.n || 0);
        });
    }
}
exports.EstimatedDocumentCountOperation = EstimatedDocumentCountOperation;
operation_1.defineAspects(EstimatedDocumentCountOperation, [operation_1.Aspect.READ_OPERATION, operation_1.Aspect.RETRYABLE]);
//# sourceMappingURL=estimated_document_count.js.map